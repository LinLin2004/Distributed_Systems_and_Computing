
# æ‰‹åŠ¨å®ç°å¤šä¼˜åŒ–ç®—æ³•ï¼ˆä¸ä½¿ç”¨ PyTorch å†…å»º Optimizerï¼‰ MLP åˆ†ç±»å®éªŒæ¡†æ¶
æœ¬é¡¹ç›®ä¸ºåŸºäº PyTorch å®ç°çš„ æ‰‹åŠ¨ä¼˜åŒ–å™¨å®éªŒæ¡†æ¶ï¼Œæ”¯æŒåœ¨ MNIST æ•°æ®é›†ä¸Šæµ‹è¯•å¤šä¸ªä¼˜åŒ–ç®—æ³•ï¼ŒåŒ…æ‹¬å­¦ä¹ ç‡æœç´¢ã€ç®—æ³•æ¯”è¾ƒã€è¶…å‚æ•°æ¶ˆèç­‰å®éªŒã€‚

---

## ğŸš€ ä½¿ç”¨æ–¹å¼

åœ¨ç»ˆç«¯ä¸­è¿è¡Œï¼š

```bash
python main.py [OPTIONS]
```

æ‰€æœ‰å‚æ•°å‡å¯é€šè¿‡å‘½ä»¤è¡ŒæŒ‡å®šã€‚

---

## ğŸ“Œ å‘½ä»¤è¡Œå‚æ•°è¯´æ˜

### é€šç”¨å‚æ•°
| å‚æ•°å                   | è¯´æ˜                            | é»˜è®¤å€¼                   |
| --------------------- | ----------------------------- | --------------------- |
| `--method` æˆ– `-m`     | é€‰æ‹©ä¼˜åŒ–å™¨ï¼ˆå¦‚ adamã€rmspropï¼‰         | `nesterov`            |
| `--lr` æˆ– `-r`         | å­¦ä¹ ç‡ï¼ˆæœªè®¾ç½®åˆ™éƒ¨åˆ†æ–¹æ³•é‡‡ç”¨æ¨èå€¼ï¼‰            | `None`                |
| `--num-epochs` æˆ– `-e` | è®­ç»ƒè½®æ•°                          | `500`                 |
| `--batch-size` æˆ– `-b` | æ‰¹å¤§å°                           | `2048`                |
| `--dropout`           | MLP Dropout æ¦‚ç‡                | `0.0`                 |
| `--use_bn`            | æ˜¯å¦ä½¿ç”¨ BatchNorm                | `False`               |
| `--hidden`            | éšè—å±‚ç»“æ„ï¼ˆå¦‚ `--hidden 128 64 32`ï¼‰ | `[256, 128, 128, 64]` |

### å„æ–¹æ³•ä¸“ç”¨å‚æ•°
| æ–¹æ³•       | å¯è°ƒå‚æ•°      |
| -------- | --------- |
| Adam     | `--beta1` |
| Adagrad  | `--eps`   |
| RMSProp  | `--rhor`  |
| AdaDelta | `--rho`   |
| Nesterov | `--gamma` |


### å®éªŒæ¨¡å¼å‚æ•°ï¼ˆäº’æ–¥ä½¿ç”¨ï¼‰

| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `--ablation` | flag | å¯¹å½“å‰æ–¹æ³•è¿›è¡Œè¶…å‚æ•°æ¶ˆèå®éªŒ |
| `--compare` | flag | æ¯”è¾ƒæ‰€æœ‰ä¼˜åŒ–æ–¹æ³•è¡¨ç° |
| `--search` | flag | å¯¹æ‰€æœ‰æ–¹æ³•æ‰§è¡Œå­¦ä¹ ç‡æœç´¢ |

> é»˜è®¤æƒ…å†µä¸‹ï¼ˆä¸è®¾ç½® ablation / compare / searchï¼‰ï¼Œå°†ä½¿ç”¨æŒ‡å®šç®—æ³•å’Œå­¦ä¹ ç‡è¿›è¡Œå•æ¬¡è®­ç»ƒã€‚

---

## ğŸ§ª ç¤ºä¾‹å‘½ä»¤ï¼ˆå‚è€ƒä½†ä¸é™äºï¼‰

### æ™®é€šè®­ç»ƒï¼ˆgd +å­¦ä¹ ç‡ï¼‰
```bash
python main.py -m gd -r 0.01 --num-epochs 200
```

### å­¦ä¹ ç‡æœç´¢ï¼ˆæ‰€æœ‰æ–¹æ³•ï¼‰
```bash
python main.py --search
```

### æ–¹æ³•å¯¹æ¯”ï¼ˆå›ºå®šå­¦ä¹ ç‡ï¼‰
```bash
python main.py --compare -r 0.01
```

### adam æ¶ˆèå®éªŒ
```bash
python main.py --ablation --method adam --lr 0.1
```
### adagrad æ¶ˆèå®éªŒ
```bash
python main.py -m adagrad --ablation -r 0.1
```
### rmsprop æ¶ˆèå®éªŒ
```bash
python main.py -m rmsprop --ablation -r 0.01
```
### adadelta æ¶ˆèå®éªŒ
```bash
python main.py -m adadelta --ablation -r 0.01
```
### nesterov æ¶ˆèå®éªŒ 
```bash
python main.py -m nesterov --ablation -r 0.1
```
---

## ğŸ“‚ è¾“å‡ºç»“æœ

- æ‰€æœ‰å›¾åƒä¿å­˜åœ¨ `plots/` ç›®å½•ä¸‹ã€‚ï¼ˆä¹Ÿå¯åœ¨ç›¸åº”å‡½æ•°ä¸­ä¿®æ”¹ä¿å­˜è·¯å¾„ï¼‰
- å¯è§†åŒ–åŒ…æ‹¬ï¼šæ”¶æ•›æ›²çº¿ã€å­¦ä¹ ç‡æœç´¢å›¾ã€ç®—æ³•å¯¹æ¯”å›¾ã€å‚æ•°æ¶ˆèå›¾ç­‰ã€‚
- ä½¿ç”¨ `--use_bn` å’Œ `--dropout` å¯è§‚å¯Ÿæ­£åˆ™åŒ–å¯¹ç»“æœçš„å½±å“ã€‚

---

## ğŸ“ æ¨è

- é…åˆ TensorBoard å¯è¿›ä¸€æ­¥å¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹ï¼ˆæ—¥å¿—åœ¨ `runs/`ï¼‰ã€‚

---
